I"!<h2 id="t1">T1</h2>

<h3 id="è½¬åŒ–">è½¬åŒ–</h3>
<p>ä¸Šæ¥ä¸€çœ‹è¿™é¢˜è’™äº†ï¼ŒçŒœäº†å‡ ä¸ªç»“è®ºï¼Œåˆæ‰“äº†ä¸ªè´ªå¿ƒï¼Œç»“æœåªè¿‡äº†æ ·ä¾‹ï¼Œå°±å…ˆå»æ‰“ T2 äº†ã€‚</p>

<p>æ‰“å®Œ T2 å›åˆ°è¿™é¢˜ï¼Œä»”ç»†æƒ³æƒ³ï¼Œå‘ç°è¿™ä¸ªç­”æ¡ˆæ˜¯å¾ˆéš¾ç›´æ¥åœ¨è¾“å…¥å­—ç¬¦ä¸²åºåˆ—ä¸Š dp çš„ï¼Œæ•…è€ƒè™‘æ„é€ ç‰›æ–‡å­—æ¯è¡¨çš„é¡ºåºï¼Œä½¿å¾—ç»“æœæœ€å°ã€‚</p>

<p>å…ˆè·³è¿‡æ„é€ çš„è¿‡ç¨‹ï¼Œå‡è®¾æˆ‘ä»¬ç›®å‰å·²ç»çŸ¥é“ï¼Œç‰›æ–‡å­—æ¯è¡¨çš„é¡ºåºå°±æ˜¯ abcdefgâ€¦ æˆ‘ä»¬å¦‚ä½•å¿«é€Ÿçš„æ±‚å‡ºè¾“å…¥åºåˆ—çš„ç­”æ¡ˆå‘¢ï¼Ÿ</p>

<p>ä¸å¦¨è®¾è¾“å…¥åºåˆ—ä¸º<code>abcba</code>ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸ªåºåˆ—æœ€å°‘éœ€è¦å”±3æ¬¡æ‰èƒ½å‡ºç°ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå”±ç¬¬ä¸€æ¬¡å¯ä»¥å‡ºç°åˆ°<code>abc</code>ä½†æ˜¯ä¸‹ä¸€é¡¹<code>b</code>çš„å­—å…¸åºæ¯”<code>c</code>é å‰ï¼Œæ‰€ä»¥<code>b</code>å°±åªèƒ½å†å”±ä¸€æ¬¡äº†ï¼Œä¸‹ä¸€é¡¹<code>a</code>ä¹Ÿæ˜¯åŒç†ï¼Œæ‰€ä»¥è¿™ä¸ªåºåˆ—çš„ç­”æ¡ˆæ˜¯ 3 ã€‚</p>

<p>æ€»ç»“ä¸€ä¸‹ï¼Œç­”æ¡ˆä¸ºï¼š</p>

<p>$1+\sum_{i \in [1,n-1]}{(dict[str[i]]&gt;=dict[str[i+1]])}$</p>

<p>å…¶ä¸­ dict[x] è¡¨ç¤º x å­—ç¬¦åœ¨ç‰›æ–‡å­—æ¯è¡¨ä¸­æ’åœ¨ç¬¬å‡ ä¸ª</p>

<h3 id="å¦‚ä½•dp">å¦‚ä½•dp</h3>

<h4 id="çŠ¶æ€">çŠ¶æ€</h4>

<p>ç°åœ¨æˆ‘ä»¬è¦æ„é€ ä¸€ä¸ªç‰›æ–‡åºåˆ—ï¼Œ26! çš„ç®—æ³•è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œä½†æ˜¯è§‚å¯Ÿæ•°æ®èŒƒå›´æˆ‘ä»¬å‘ç°æš—è—ç„æœºï¼š</p>

<blockquote>
  <ul>
    <li>æµ‹è¯•ç‚¹ 6-16 ä¸­ï¼ŒFarmer Nhoj ä»æœªå¬åˆ°ä»»ä½•å‡ºç°åœ¨ Mildred åå­—ä¸­çš„å­—æ¯ã€‚</li>
  </ul>
</blockquote>

<p>ä¹Ÿå°±æ˜¯è¯´å­—ç¬¦é›†åªæœ‰ 20 ä¸ªï¼Œæ˜¯å¯ä»¥çŠ¶å‹ dp çš„ã€‚</p>

<p>äºæ˜¯æˆ‘ä»¬ä»å°åˆ°å¤§æ„é€ ä¸€ä¸ªç‰›æ–‡å­—æ¯è¡¨ï¼Œdp[s] ï¼ˆsæ˜¯çŠ¶å‹å‡ºæ¥çš„æ•°ï¼‰è¡¨ç¤ºå½“å‰æ„é€ çš„å­—æ¯è¡¨ä¸­ï¼Œå·²ç»åŒ…å«äº† s è¿™äº›å­—ç¬¦çš„æ—¶å€™ï¼Œç­”æ¡ˆçš„æœ€å°å€¼ã€‚</p>

<h4 id="è½¬ç§»">è½¬ç§»ï¼š</h4>

<p>é‡‡ç”¨â€œæˆ‘ä¸ºäººäººâ€çš„ dp æ–¹å¼ï¼Œå½“æˆ‘ä»¬æ–°åŠ å…¥ä¸€ä¸ªå­—ç¬¦ x çš„æ—¶å€™ï¼Œå¦‚ä½•è®¡ç®—ç­”æ¡ˆä¼šå¢åŠ å¤šå°‘å‘¢ï¼Ÿ</p>

<p>æˆ‘ä»¬åªéœ€çŸ¥é“æœ‰å¤šå°‘ä¸ª i æ»¡è¶³ \((str[i]==x)\ and\ str[i+1]\in (s\cup\{x\})\)ï¼Œäºæ˜¯æˆ‘å¼€äº†ä¸ªæ¡¶å¹¶æš´åŠ›å®ç°è¿™ä¸ªï¼Œè¯¦è§ä»£ç </p>

<p>æ­¤é¢˜å¤æ‚åº¦ \(O(2^{20}\times 20^2)\)</p>

<h3 id="ä»£ç ">ä»£ç </h3>

<pre><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;
#define fi first
#define se second
#define pb push_back
#define mp make_pair
#define rd scanf
#define pt printf
#define setp(x) setprecision(x)
#define mem(x,y) memset(x,y,sizeof(x))
#define sz(x) (int)x.size()
#define umn(x,y) x=min(x,y)
#define umx(x,y) x=max(x,y)
typedef long long ll;
typedef unsigned long long ull;
typedef pair&lt;ll,ll&gt; pi;
typedef vector&lt;ll&gt; vi;
typedef vector&lt;pi&gt; vpi;

const double eps=1e-9;
const ll INF=1e18;
const ll P=998244353;
const ll MXN=1e5+5;

inline ll mod(ll x){return x&gt;=P?x-P:x;}
inline ll mul(ll x,ll y){if(x&lt;y)swap(x,y);ll res=0;while(y){if(y&amp;1)res=mod(res+x);x=mod(x&lt;&lt;1);y&gt;&gt;=1;}return res;}
inline ll qpow(ll x,ll y){ll res=1;while(y){if(y&amp;1)res=res*x%P;x=x*x%P;y&gt;&gt;=1;}return res;}
ll gcd(ll x,ll y){return !y?x:gcd(y,x%y);}
inline void pbin(ll x,ll y){for(;~y;y--)cerr&lt;&lt;char('0'+((x&gt;&gt;y)&amp;1));cerr&lt;&lt;endl;}



const int CSZ=26;
const int MXSZ=20;
ll n;
char str[MXN];
ll cnt[MXSZ][MXSZ];
ll dp[1&lt;&lt;MXSZ];
ll table[CSZ],sz;


#define toi(x) table[(x)-'a']



inline void solve(){
    //codes
	cin&gt;&gt;(str+1);
	n=strlen(str+1);
	mem(table,-1);
	for(int i=1;i&lt;=n;i++)
		if(toi(str[i])==-1)
			toi(str[i])=sz++;

	for(int i=1;i&lt;n;i++)
		cnt[toi(str[i])][toi(str[i+1])]++;

	mem(dp,0x3f);
	dp[0]=1;
	for(int i=0;i&lt;(1&lt;&lt;sz);i++){
		/*pbin(i,5);
		cout&lt;&lt;dp[i]&lt;&lt;endl;*/
		for(int j=0;j&lt;sz;j++)
			if(!((i&gt;&gt;j)&amp;1)){
				ll tmp=dp[i]+cnt[j][j];
				for(int k=0;k&lt;sz;k++)
					if((i&gt;&gt;k)&amp;1)
						tmp+=cnt[j][k];
				umn(dp[i^(1&lt;&lt;j)],tmp);
			}
	}
	cout&lt;&lt;dp[(1&lt;&lt;sz)-1];


}
int main(){
	//freopen(".in","r",stdin);
	//freopen(".out","w",stdout);
	ios_base::sync_with_stdio(0);cin.tie(0);
	cout&lt;&lt;setiosflags(ios::fixed);
	srand(time(NULL));

	solve();
	return 0;
}
</code></pre>

<h2 id="t2">T2</h2>

<p>æ‰“äº†ä¸€ä¸ªè£¸çš„ spfaï¼Œå¾—åˆ°92åˆ†çš„å¥½æˆç»©</p>

<h3 id="ä»£ç -1">ä»£ç </h3>

<pre><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;
#define fi first
#define se second
#define pb push_back
#define mp make_pair
#define rd scanf
#define pt printf
#define setp(x) setprecision(x)
#define mem(x,y) memset(x,y,sizeof(x))
#define sz(x) (int)x.size()
#define umn(x,y) x=min(x,y)
#define umx(x,y) x=max(x,y)
typedef long long ll;
typedef unsigned long long ull;
typedef pair&lt;ll,ll&gt; pi;
typedef vector&lt;ll&gt; vi;
typedef vector&lt;pi&gt; vpi;

const double eps=1e-9;
const ll INF=1e18;
const ll P=998244353;
const ll MXN=1e5+5;
const ll MXK=55;

inline ll mod(ll x){return x&gt;=P?x-P:x;}
inline ll mul(ll x,ll y){if(x&lt;y)swap(x,y);ll res=0;while(y){if(y&amp;1)res=mod(res+x);x=mod(x&lt;&lt;1);y&gt;&gt;=1;}return res;}
inline ll qpow(ll x,ll y){ll res=1;while(y){if(y&amp;1)res=res*x%P;x=x*x%P;y&gt;&gt;=1;}return res;}
ll gcd(ll x,ll y){return !y?x:gcd(y,x%y);}
inline void pbin(ll x,ll y){for(;~y;y--)cerr&lt;&lt;char('0'+((x&gt;&gt;y)&amp;1));cerr&lt;&lt;endl;}



ll n,k;
ll dis[MXN],tp[MXN];
vi ec[MXK],ek[MXK];
bool inq[MXN];
inline void spfa(){
	mem(dis,0x3f);
	deque&lt;ll&gt; q;
	q.push_front(1);
	dis[1]=0;
	while(!q.empty()){
		ll p=q.front();
		q.pop_front();
		inq[p]=0;
		int ctp=tp[p];
		for(int i=0;i&lt;sz(ek[ctp]);i++){
			int ntp=ek[ctp][i];
			for(int j=0;j&lt;sz(ec[ntp]);j++){
				int nc=ec[ntp][j];
				int nw=dis[p]+abs(nc-p);
				if(nw&lt;dis[nc]){
					dis[nc]=nw;
					if(!inq[nc]){
						inq[nc]=1;
						q.empty() || dis[nc]&lt;=dis[q.front()] ? q.push_front(nc):q.push_back(nc);
					}
				}
			}
		}
	}
}
inline void solve(){
    //codes
	cin&gt;&gt;n&gt;&gt;k;
	for(int i=1;i&lt;=n;i++){
		cin&gt;&gt;tp[i];
		ec[tp[i]].pb(i);
	}
	for(int i=1;i&lt;=k;i++){
		char str[MXK];
		cin&gt;&gt;(str+1);
		for(int j=1;j&lt;=k;j++)
			if(str[j]=='1')
				ek[i].pb(j);
	}
	spfa();
	cout&lt;&lt;(dis[n]&lt;1e16?dis[n]:-1);
}
int main(){
	//freopen(".in","r",stdin);
	//freopen(".out","w",stdout);
	ios_base::sync_with_stdio(0);cin.tie(0);
	cout&lt;&lt;setiosflags(ios::fixed);
	srand(time(NULL));

	solve();
	return 0;
}
</code></pre>

<h2 id="t3">T3</h2>

<p>æ‰“äº†ä¸€ä¸ªæš´åŠ›ï¼Œå¾—åˆ° 25 åˆ†çš„å¥½æˆç»©ï¼Œæ—¶é—´ä¸å¤ªå¤Ÿï¼Œæ‡’å¾—æƒ³ 50 åˆ†äº†ï¼Œå¬è¯´ 50 åˆ†æ˜¯é“¶ç»„ T1ã€‚</p>
<h3 id="ä»£ç -2">ä»£ç </h3>

<pre><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;
#define fi first
#define se second
#define pb push_back
#define mp make_pair
#define rd scanf
#define pt printf
#define setp(x) setprecision(x)
#define mem(x,y) memset(x,y,sizeof(x))
#define sz(x) (int)x.size()
#define umn(x,y) x=min(x,y)
#define umx(x,y) x=max(x,y)
typedef long long ll;
typedef unsigned long long ull;
typedef pair&lt;ll,ll&gt; pi;
typedef vector&lt;ll&gt; vi;
typedef vector&lt;pi&gt; vpi;

const double eps=1e-9;
const ll INF=1e18;
const ll P=998244353;
const ll MXN=200+5;

inline ll mod(ll x){return x&gt;=P?x-P:x;}
inline ll mul(ll x,ll y){if(x&lt;y)swap(x,y);ll res=0;while(y){if(y&amp;1)res=mod(res+x);x=mod(x&lt;&lt;1);y&gt;&gt;=1;}return res;}
inline ll qpow(ll x,ll y){ll res=1;while(y){if(y&amp;1)res=res*x%P;x=x*x%P;y&gt;&gt;=1;}return res;}
ll gcd(ll x,ll y){return !y?x:gcd(y,x%y);}
inline void pbin(ll x,ll y){for(;~y;y--)cerr&lt;&lt;char('0'+((x&gt;&gt;y)&amp;1));cerr&lt;&lt;endl;}



ll n,m,k;
pi arr[MXN],suf[MXN];
ll last[MXN];

bool vis[MXN],cc[MXN][MXN];
inline void cal(ll x){
	mem(vis,0);
	mem(cc,0);

	ll ans=1,ct=last[x],tot=last[x];
	vis[x]=1,cc[0][x]=1;
	while(tot&lt;=m &amp;&amp; !cc[ct][x]){
		cc[ct][x]=1;
		if(!vis[x]){
			ans++;
			vis[x]=1;
		}
		if(x==arr[ct].fi){
			x=arr[ct].se;
			ll nx=suf[ct].se;
			tot+=nx-ct&lt;=0?nx-ct+k:nx-ct;
			ct=nx;
		}
		else{
			x=arr[ct].fi;
			ll nx=suf[ct].fi;
			tot+=nx-ct&lt;=0?nx-ct+k:nx-ct;
			ct=nx;
		}
	}
		if(!vis[x]){
			ans++;
			vis[x]=1;
		}
	cout&lt;&lt;ans&lt;&lt;endl;
}


inline void solve(){
    //codes
	cin&gt;&gt;n&gt;&gt;k&gt;&gt;m;
	for(int i=1;i&lt;=k;i++)
		cin&gt;&gt;arr[i].fi&gt;&gt;arr[i].se;
	for(int i=k;i;i--){
		suf[i].fi=last[arr[i].fi];
		suf[i].se=last[arr[i].se];
		last[arr[i].fi]=last[arr[i].se]=i;
	}
	for(int i=k;i;i--){
		suf[i].fi=last[arr[i].fi];
		suf[i].se=last[arr[i].se];
		last[arr[i].fi]=last[arr[i].se]=i;
	}
	for(int i=1;i&lt;=n;i++)cal(i);
}
int main(){
	//freopen(".in","r",stdin);
	//freopen(".out","w",stdout);
	ios_base::sync_with_stdio(0);cin.tie(0);
	cout&lt;&lt;setiosflags(ios::fixed);
	srand(time(NULL));

	solve();
	return 0;
}
</code></pre>
:ET