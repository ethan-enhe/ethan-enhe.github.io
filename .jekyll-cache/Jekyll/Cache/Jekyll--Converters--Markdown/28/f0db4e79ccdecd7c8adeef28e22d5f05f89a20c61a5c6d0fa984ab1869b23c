I"<p>介绍一种 ${\rm O}(n \times 3^8)$ 的做法，目前是所有非打表代码中的最优解，<del>其实只是把其他题解中的算法优化了一下。</del></p>

<h2 id="暴力">暴力</h2>

<p>这题的暴力有很多种，在此只介绍可以优化成正解的暴力。</p>

<p>两个数互质，等效于他们没有共同的质因子，所以只需把每个数都分解质质因数，如下dp：</p>

<ul>
  <li>状态：$dp[s1][s2]$ 表示考虑前 i 个数（i被滚动掉了），小 G 选的数的包含的质因数集合为 s1，小 W 的质因数集合为 s2 的情况数。</li>
  <li>转移：
假设 $fac_i$ 表示 i 的质因数集合，则有转移：</li>
</ul>

:ET